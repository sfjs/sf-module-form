!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("sf"));else if("function"==typeof define&&define.amd)define(["sf"],t);else{var s=t("object"==typeof exports?require("sf"):e.sf);for(var o in s)("object"==typeof exports?exports:e)[o]=s[o]}}(this,function(__WEBPACK_EXTERNAL_MODULE_1__){return function(e){function t(o){if(s[o])return s[o].exports;var r=s[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var s={};return t.m=e,t.c=s,t.p="",t(0)}([function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var r=s(1),n=o(r),i=s(2),a=o(i);n["default"].instancesController.registerInstanceType(a["default"],"js-sf-form"),e.exports=a["default"]},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_1__},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}var _assign=__webpack_require__(3),_assign2=_interopRequireDefault(_assign),_create=__webpack_require__(18),_create2=_interopRequireDefault(_create);Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _sf=__webpack_require__(1),_sf2=_interopRequireDefault(_sf),formMessages=__webpack_require__(20);__webpack_require__(25);var Form=function(e,t,s){this._construct(e,t,s)};Form.prototype=(0,_create2["default"])(_sf2["default"].modules.core.BaseDOMConstructor.prototype),Form.prototype.name="form",Form.prototype._construct=function(e,t,s){this.init(e,t,s),this.mixMessagesOptions(),this.DOMEvents=new this.sf.modules.helpers.DOMEvents,this.addEvents(),this.events=new this.sf.modules.core.Events(["beforeSend","success","error","always"])},Form.prototype.optionsToGrab={context:{processor:function(e,t){return e}},self:{processor:function(e,t){return this}},url:{domAttr:"action",value:"/"},method:{domAttr:"method",value:"POST"},lockType:{value:"default",domAttr:"data-lockType"},messagesType:{value:"spiral",domAttr:"data-messagesType"},messages:{value:"",domAttr:"data-messages",processor:function(e,t,s){if(!t)return this.value;if("string"==typeof t)try{t=JSON.parse(t)}catch(o){console.error("Form JSON.parse error: ",o)}return(0,_assign2["default"])(s.value,t)}},useAjax:{value:!0,domAttr:"data-useAjax",processor:function(e,t){return"boolean"==typeof t?t:(t=void 0!==t&&null!==t?t.toLowerCase():"","false"===t?t=!1:"true"===t&&(t=!0),t)}},ajaxCallback:{value:!1,domAttr:"data-callback"},beforeSubmitCallback:{value:!1,domAttr:"data-before-submit"},afterSubmitCallback:{value:!1,domAttr:"data-after-submit"},headers:{value:{Accept:"application/json"},domAttr:"data-headers",processor:function(e,t,s){if(void 0===t||null==t)return this.value;if("string"==typeof t)try{t=JSON.parse(t)}catch(o){console.error("Form JSON.parse error: ",o)}return(0,_assign2["default"])(s.value,t)}}},Form.prototype.mixMessagesOptions=function(){var e=this.sf.options.instances.form;this.options.messages=(0,_assign2["default"])({},formMessages.defaults,e&&e.messages&&e.messages[this.options.messagesType],this.options.messages)},Form.prototype.onSubmit=function(e){return this.sf.instancesController.getInstance("lock",this.node)?(e.preventDefault(),void e.stopPropagation()):(this.removeMessages(),this.options.data=this.getFormData(),window.FormData||0===this.options.context.querySelectorAll("input[type='file']").length||(this.options.useAjax=!1),this.events.trigger("beforeSend",this.options),void(this.options.useAjax&&(this.send(this.options),e.preventDefault(),e.stopPropagation())))},Form.prototype.lock=function(e){this.options.lockType&&"none"!==this.options.lockType&&(e?this.sf.instancesController.removeInstance("lock",this.node)||console.warn("You try to remove 'lock' instance, but it is not available or not started"):this.sf.instancesController.addInstance("lock",this.node,{type:this.options.lockType})||console.warn("You try to add 'lock' instance, but it is not available or already started"))},Form.prototype.showFormMessage=formMessages.showFormMessage,Form.prototype.showFieldMessage=formMessages.showFieldMessage,Form.prototype.showFieldsMessages=formMessages.showFieldsMessages,Form.prototype.showMessages=formMessages.showMessages,Form.prototype.removeMessages=formMessages.removeMessages,Form.prototype.removeMessage=formMessages.removeMessage,Form.prototype.processAnswer=function(e){this.options.messagesType&&this.showMessages(e)},Form.prototype.send=function(sendOptions){var that=this;if(this.lock(),sendOptions.beforeSubmitCallback){var fn=eval(sendOptions.beforeSubmitCallback);"function"==typeof fn&&fn.call(sendOptions)}this.sf.ajax.send(sendOptions).then(function(e){return that.events.trigger("success",sendOptions),e},function(e){return that.events.trigger("error",sendOptions),e}).then(function(e){that.lock(!0),that.processAnswer(e),that.events.trigger("always",sendOptions)})},Form.prototype.getFormData=function(){return window.FormData?new FormData(this.options.context):(console.log("Form `"+this.options.context+"` were processed without FormData."),new formToObject(this.options.context))},Form.prototype.setOptions=function(e){this.options=this.sf.modules.helpers.tools.extend(this.options,e)},Form.prototype.addEvents=function(){var e=this;this.DOMEvents.add([{DOMNode:this.options.context,eventType:"submit",eventFunction:function(t){e.onSubmit.call(e,t)}}])},Form.prototype.die=function(){this.DOMEvents.removeAll()},exports["default"]=Form},function(e,t,s){e.exports={"default":s(4),__esModule:!0}},function(e,t,s){s(5),e.exports=s(8).Object.assign},function(e,t,s){var o=s(6);o(o.S+o.F,"Object",{assign:s(11)})},function(e,t,s){var o=s(7),r=s(8),n=s(9),i="prototype",a=function(e,t,s){var c,u,l,f=e&a.F,p=e&a.G,m=e&a.S,h=e&a.P,d=e&a.B,g=e&a.W,v=p?r:r[t]||(r[t]={}),y=p?o:m?o[t]:(o[t]||{})[i];p&&(s=t);for(c in s)u=!f&&y&&c in y,u&&c in v||(l=u?y[c]:s[c],v[c]=p&&"function"!=typeof y[c]?s[c]:d&&u?n(l,o):g&&y[c]==l?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t[i]=e[i],t}(l):h&&"function"==typeof l?n(Function.call,l):l,h&&((v[i]||(v[i]={}))[c]=l))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,e.exports=a},function(e,t){var s=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=s)},function(e,t){var s=e.exports={version:"1.2.6"};"number"==typeof __e&&(__e=s)},function(e,t,s){var o=s(10);e.exports=function(e,t,s){if(o(e),void 0===t)return e;switch(s){case 1:return function(s){return e.call(t,s)};case 2:return function(s,o){return e.call(t,s,o)};case 3:return function(s,o,r){return e.call(t,s,o,r)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,s){var o=s(12),r=s(13),n=s(15);e.exports=s(17)(function(){var e=Object.assign,t={},s={},o=Symbol(),r="abcdefghijklmnopqrst";return t[o]=7,r.split("").forEach(function(e){s[e]=e}),7!=e({},t)[o]||Object.keys(e({},s)).join("")!=r})?function(e,t){for(var s=r(e),i=arguments,a=i.length,c=1,u=o.getKeys,l=o.getSymbols,f=o.isEnum;a>c;)for(var p,m=n(i[c++]),h=l?u(m).concat(l(m)):u(m),d=h.length,g=0;d>g;)f.call(m,p=h[g++])&&(s[p]=m[p]);return s}:Object.assign},function(e,t){var s=Object;e.exports={create:s.create,getProto:s.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:s.getOwnPropertyDescriptor,setDesc:s.defineProperty,setDescs:s.defineProperties,getKeys:s.keys,getNames:s.getOwnPropertyNames,getSymbols:s.getOwnPropertySymbols,each:[].forEach}},function(e,t,s){var o=s(14);e.exports=function(e){return Object(o(e))}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,s){var o=s(16);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==o(e)?e.split(""):Object(e)}},function(e,t){var s={}.toString;e.exports=function(e){return s.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t,s){e.exports={"default":s(19),__esModule:!0}},function(e,t,s){var o=s(12);e.exports=function(e,t){return o.create(e,t)}},function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){return"[object Object]"!==Object.prototype.toString.call(e)&&(e={text:e,type:t}),e.text=e.text||e.message||e,e.type=e.type||t,e}var n=s(21),i=o(n),a={template:'<div class="alert form-msg ${type}"><button class="btn-close">Ã—</button><p class="msg">${text}</p></div>',close:".btn-close",place:"bottom",levels:{success:"success",info:"info",warning:"warning",error:"error"},field:".item-form",fieldTemplate:'<div class="alert form-msg ${type}"><p class="msg">${text}</p></div>',fieldClose:".btn-close",fieldPlace:"bottom",fieldPrefix:""};a.levels.message=a.levels.success,a.levels.debug=a.levels.success,a.levels.info=a.levels.notice=a.levels.info,a.levels.danger=a.levels.critical=a.levels.alert=a.levels.emergency=a.levels.error,e.exports={defaults:a,showMessages:function(e){if(e){var t=!1,s=this;for(var o in this.options.messages.levels)e[o]&&(this.showFormMessage(e[o],this.options.messages.levels[o]),t=!0);if(e.messages&&(this.showFieldsMessages(e.messages,"success"),t=!0),e.errors&&(this.showFieldsMessages(e.errors,"error"),t=!0),e.warnings&&(this.showFieldsMessages(e.warnings,"warning"),t=!0),!t){var r=e.status?e.status+" ":"";r+=e.statusText?e.statusText:"",r+=e.data&&!e.statusText?e.data:"",r+=0===r.length?e:"",this.showFormMessage(r,"error")}this._messages.forEach(function(e){e.close&&(e.closeHandler=s.removeMessage.bind(s,e),e.close.addEventListener("click",e.closeHandler))})}},removeMessage:function(e,t){e.close&&e.close.removeEventListener("click",e.closeHandler),e.el.parentNode.removeChild(e.el),e.field&&e.field.classList.remove(this.options.messages.fieldPrefix+e.type),t&&(t.preventDefault&&t.preventDefault(),this._messages.splice(this._messages.indexOf(e),1))},removeMessages:function(){var e=this;this._messages&&this._messages.forEach(function(t){e.removeMessage(t,!1)}),e._messages=[]},showFormMessage:function(e,t){e=r(e,t);var s,o,n=this.options.messages.template,i=new DOMParser;for(var a in e){if(!e.hasOwnProperty(a))return;n=n.replace("${"+a+"}",e[a])}s=i.parseFromString(n,"text/html").firstChild.lastChild.firstChild,"bottom"===this.options.messages.place?this.node.appendChild(s):"top"===this.options.messages.place?this.node.insertBefore(s,this.node.firstChild):(o=document.querySelector(this.options.messages.place),o.appendChild(s)),this._messages.push({el:s,close:s.querySelector(this.options.messages.close)})},showFieldMessage:function(e,t,s,o){var n,i=o?e:sf.helpers.domTools.closest(e,this.options.messages.field),a=this.options.messages.fieldTemplate;if(i){var c=new DOMParser;t=r(t,s),i.classList.add(this.options.messages.fieldPrefix+s);for(var u in t){if(!t.hasOwnProperty(u))return;a=a.replace("${"+u+"}",t[u])}n=c.parseFromString(a,"text/html").firstChild.lastChild.firstChild,"bottom"===this.options.messages.fieldPlace?i.appendChild(n):"top"===this.options.messages.fieldPlace?i.insertBefore(n,i.firstChild):(i=i.querySelector(this.options.messages.fieldPlace),i.appendChild(n)),this._messages.push({el:n,close:n.querySelector(this.options.messages.fieldClose),field:i,type:s})}},showFieldsMessages:function(e,t){var s=this,o=sf.helpers.tools.iterateInputs(this.node,e,function(e,o){s.showFieldMessage(e,o,t)});o.forEach(function(e){(0,i["default"])(e).forEach(function(o){var r=s.node.querySelector('[data-message-placeholder="'+o+'"]');r&&s.showFieldMessage(r,e[o],t,!0)})})}}},function(e,t,s){e.exports={"default":s(22),__esModule:!0}},function(e,t,s){s(23),e.exports=s(8).Object.keys},function(e,t,s){var o=s(13);s(24)("keys",function(e){return function(t){return e(o(t))}})},function(e,t,s){var o=s(6),r=s(8),n=s(17);e.exports=function(e,t){var s=(r.Object||{})[e]||Object[e],i={};i[e]=t(s),o(o.S+o.F*n(function(){s(1)}),"Object",i)}},function(e,t,s){function o(e){return e&&e.__esModule?e:{"default":e}}var r,n=s(26),i=o(n);/*! github.com/serbanghita/formToObject.js 1.0.1  (c) 2013 Serban Ghita <serbanghita@gmail.com> @licence MIT */
!function(){var o=function(e){return e?(this.formRef=e,this.keyRegex=/[^\[\]]+/g,this.$form=null,this.$formElements=[],this.formObj={},this.setForm()&&this.setFormElements()?this.setFormObj():!1):!1};o.prototype.setForm=function(){switch((0,i["default"])(this.formRef)){case"string":this.$form=document.getElementById(this.formRef);break;case"object":this.isDomNode(this.formRef)&&(this.$form=this.formRef)}return this.$form},o.prototype.setFormElements=function(){return this.$formElements=this.$form.querySelectorAll("input, textarea, select"),this.$formElements.length},o.prototype.isDomNode=function(e){return"object"===("undefined"==typeof e?"undefined":(0,i["default"])(e))&&"nodeType"in e&&1===e.nodeType},o.prototype.forEach=function(e,t){if([].forEach)return[].forEach.call(e,t);var s;for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(e,e[s])},o.prototype.addChild=function(e,t,s,o){if(1===s.length){if("INPUT"===t.nodeName&&"radio"===t.type)return t.checked?e[s]=o:void 0;if("INPUT"===t.nodeName&&"checkbox"===t.type)return t.checked?(e[s]||(e[s]=[]),e[s].push(o)):void 0;if("SELECT"===t.nodeName&&"select-multiple"===t.type){e[s]=[];var r=t.querySelectorAll("option[selected]");return void(r&&this.forEach(r,function(t){e[s].push(t.value)}))}e[s]=o}return s.length>1?(e[s[0]]||(e[s[0]]={}),this.addChild(e[s[0]],t,s.splice(1,s.length),o)):e},o.prototype.setFormObj=function(){var e,t=0;for(t=0;t<this.$formElements.length;t++)this.$formElements[t].name&&!this.$formElements[t].disabled&&(e=this.$formElements[t].name.match(this.keyRegex),this.addChild(this.formObj,this.$formElements[t],e,this.$formElements[t].value));return this.formObj},r=function(){return o}.call(t,s,t,e),!(void 0!==r&&(e.exports=r))}()},function(e,t,s){"use strict";var o=s(27)["default"];t["default"]=function(e){return e&&e.constructor===o?"symbol":typeof e},t.__esModule=!0},function(e,t,s){e.exports={"default":s(28),__esModule:!0}},function(e,t,s){s(29),s(47),e.exports=s(8).Symbol},function(e,t,s){"use strict";var o=s(12),r=s(7),n=s(30),i=s(31),a=s(6),c=s(32),u=s(17),l=s(35),f=s(36),p=s(38),m=s(37),h=s(39),d=s(41),g=s(42),v=s(43),y=s(44),b=s(40),_=s(34),x=o.getDesc,w=o.setDesc,O=o.create,M=d.get,F=r.Symbol,S=r.JSON,E=S&&S.stringify,j=!1,k=m("_hidden"),P=o.isEnum,D=l("symbol-registry"),C=l("symbols"),T="function"==typeof F,A=Object.prototype,N=i&&u(function(){return 7!=O(w({},"a",{get:function(){return w(this,"a",{value:7}).a}})).a})?function(e,t,s){var o=x(A,t);o&&delete A[t],w(e,t,s),o&&e!==A&&w(A,t,o)}:w,q=function(e){var t=C[e]=O(F.prototype);return t._k=e,i&&j&&N(A,e,{configurable:!0,set:function(t){n(this,k)&&n(this[k],e)&&(this[k][e]=!1),N(this,e,_(1,t))}}),t},$=function(e){return"symbol"==typeof e},R=function(e,t,s){return s&&n(C,t)?(s.enumerable?(n(e,k)&&e[k][t]&&(e[k][t]=!1),s=O(s,{enumerable:_(0,!1)})):(n(e,k)||w(e,k,_(1,{})),e[k][t]=!0),N(e,t,s)):w(e,t,s)},I=function(e,t){y(e);for(var s,o=g(t=b(t)),r=0,n=o.length;n>r;)R(e,s=o[r++],t[s]);return e},L=function(e,t){return void 0===t?O(e):I(O(e),t)},B=function(e){var t=P.call(this,e);return t||!n(this,e)||!n(C,e)||n(this,k)&&this[k][e]?t:!0},J=function(e,t){var s=x(e=b(e),t);return!s||!n(C,t)||n(e,k)&&e[k][t]||(s.enumerable=!0),s},K=function(e){for(var t,s=M(b(e)),o=[],r=0;s.length>r;)n(C,t=s[r++])||t==k||o.push(t);return o},W=function(e){for(var t,s=M(b(e)),o=[],r=0;s.length>r;)n(C,t=s[r++])&&o.push(C[t]);return o},G=function(e){if(void 0!==e&&!$(e)){for(var t,s,o=[e],r=1,n=arguments;n.length>r;)o.push(n[r++]);return t=o[1],"function"==typeof t&&(s=t),(s||!v(t))&&(t=function(e,t){return s&&(t=s.call(this,e,t)),$(t)?void 0:t}),o[1]=t,E.apply(S,o)}},U=u(function(){var e=F();return"[null]"!=E([e])||"{}"!=E({a:e})||"{}"!=E(Object(e))});T||(F=function(){if($(this))throw TypeError("Symbol is not a constructor");return q(p(arguments.length>0?arguments[0]:void 0))},c(F.prototype,"toString",function(){return this._k}),$=function(e){return e instanceof F},o.create=L,o.isEnum=B,o.getDesc=J,o.setDesc=R,o.setDescs=I,o.getNames=d.get=K,o.getSymbols=W,i&&!s(46)&&c(A,"propertyIsEnumerable",B,!0));var H={"for":function(e){return n(D,e+="")?D[e]:D[e]=F(e)},keyFor:function(e){return h(D,e)},useSetter:function(){j=!0},useSimple:function(){j=!1}};o.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(e){var t=m(e);H[e]=T?t:q(t)}),j=!0,a(a.G+a.W,{Symbol:F}),a(a.S,"Symbol",H),a(a.S+a.F*!T,"Object",{create:L,defineProperty:R,defineProperties:I,getOwnPropertyDescriptor:J,getOwnPropertyNames:K,getOwnPropertySymbols:W}),S&&a(a.S+a.F*(!T||U),"JSON",{stringify:G}),f(F,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(e,t){var s={}.hasOwnProperty;e.exports=function(e,t){return s.call(e,t)}},function(e,t,s){e.exports=!s(17)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,s){e.exports=s(33)},function(e,t,s){var o=s(12),r=s(34);e.exports=s(31)?function(e,t,s){return o.setDesc(e,t,r(1,s))}:function(e,t,s){return e[t]=s,e}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,s){var o=s(7),r="__core-js_shared__",n=o[r]||(o[r]={});e.exports=function(e){return n[e]||(n[e]={})}},function(e,t,s){var o=s(12).setDesc,r=s(30),n=s(37)("toStringTag");e.exports=function(e,t,s){e&&!r(e=s?e:e.prototype,n)&&o(e,n,{configurable:!0,value:t})}},function(e,t,s){var o=s(35)("wks"),r=s(38),n=s(7).Symbol;e.exports=function(e){return o[e]||(o[e]=n&&n[e]||(n||r)("Symbol."+e))}},function(e,t){var s=0,o=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++s+o).toString(36))}},function(e,t,s){var o=s(12),r=s(40);e.exports=function(e,t){for(var s,n=r(e),i=o.getKeys(n),a=i.length,c=0;a>c;)if(n[s=i[c++]]===t)return s}},function(e,t,s){var o=s(15),r=s(14);e.exports=function(e){return o(r(e))}},function(e,t,s){var o=s(40),r=s(12).getNames,n={}.toString,i="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(e){try{return r(e)}catch(t){return i.slice()}};e.exports.get=function(e){return i&&"[object Window]"==n.call(e)?a(e):r(o(e))}},function(e,t,s){var o=s(12);e.exports=function(e){var t=o.getKeys(e),s=o.getSymbols;if(s)for(var r,n=s(e),i=o.isEnum,a=0;n.length>a;)i.call(e,r=n[a++])&&t.push(r);return t}},function(e,t,s){var o=s(16);e.exports=Array.isArray||function(e){return"Array"==o(e)}},function(e,t,s){var o=s(45);e.exports=function(e){if(!o(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){e.exports=!0},function(e,t){}])});
//# sourceMappingURL=sf.form.min.js.map